<html>
<head>
<script src="http://code.createjs.com/easeljs-0.8.0.min.js"></script>
<script>
var oikealle = true; 
var stage;
var ukkoBitmap;
var blokinKoko = 50;
var skaalaus = blokinKoko/150;
var yVauhti = 0;
var xVauhti = 0;
var painovoima = -0.3;
var hyppypituus = 0;
var nappiPohjassa = false;
 
window.onload = function() {
    //Create a stage by getting a reference to the canvas
    stage = new createjs.Stage("Pelialue");

	TestiTausta = new createjs.Shape();
	TestiTausta.graphics.beginFill("blue").drawRect(0, 0, 1350, 900);
    stage.addChild(TestiTausta);
    
	ukkoBitmap = new createjs.Bitmap("Gimp/Tekstuuriset/0003 T_P‰‰hahmoLatvaEhk‰_iso.png");
	ukkoBitmap.scaleX = skaalaus;
	ukkoBitmap.scaleY = skaalaus;
	ukkoBitmap.x = 10*blokinKoko;
	ukkoBitmap.y = 10*blokinKoko;
	stage.addChild(ukkoBitmap);
	
    for(var y=11; y<12; y++) {
        for(var x=0; x<20; x++) {
            BlokkiaLisaa(x,y);
        }
    }

	// state.update() needs to be called continuously.
	// First update might not show bitmaps if they are not yet loaded.
	setInterval( liikuta, 20 ); // 20 ms = 50 FPS

    window.onkeydown = function(event) { 
			if(event.keyCode == 68 || event.keyCode == 65){
				nappiPohjassa = true;
			}
	}
	
	window.onkeyup = function(event) {
		if(event.keyCode == 68){ // D, ks. http://www.asciitable.com/
			aloitaHyppy(hyppypituus,+1);
			nappiPohjassa = false;
			hyppypituus = 0;
		}
		else if(event.keyCode == 65){ // A
			aloitaHyppy(hyppypituus,-1);
			nappiPohjassa = false;			
			hyppypituus = 0;
		}
	}
	
	// Vastaavasti voidaan tehd‰: onkeyup
}

function aloitaHyppy(pituus,suunta){
	console.log(suunta);
	yVauhti = -pituus;
	xVauhti = pituus * suunta;
}

function liikuta() {
	if(nappiPohjassa){
	hyppypituus = hyppypituus + 0.1;
	}
	ukkoBitmap.x = ukkoBitmap.x + xVauhti;
	ukkoBitmap.y = ukkoBitmap.y + yVauhti;
	yVauhti = yVauhti - painovoima;
	if(ukkoBitmap.y >= 10*blokinKoko){
		yVauhti = 0;
		xVauhti = 0;
		ukkoBitmap.y = 10*blokinKoko;
	}
	stage.update();
}

function BlokkiaLisaa(x,y) {
	var bitmap = new createjs.Bitmap("Gimp/150x150/0002 150_TestihuoneenMateriaaliPng.png");
	bitmap.scaleX = skaalaus;
	bitmap.scaleY = skaalaus;
	bitmap.x = x*blokinKoko;
	bitmap.y = y*blokinKoko;
	stage.addChild(bitmap);
}

    
 </script>
</head>
<body>
<canvas id="Pelialue" width="1350" height="900">
</canvas>
</body>
</html>